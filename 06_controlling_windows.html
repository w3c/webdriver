<section>
<h2>Controlling Windows</h2>

<p>WebDriver's use of the term “window” is equivalent to a
 <a href=https://html.spec.whatwg.org/#top-level-browsing-context>top-level
 browsing context</a>.  No distinction is made between windows or
 applications on the operating system level and user agent tabs.  This
 must not be confused with
 the <code><a href=https://html.spec.whatwg.org/#window>Window</a></code>
 object in [[!html51]].

<p>WebDriver provides functionality to manipulate
 the user agent's operating system level windows through actions such as
 <a rel="Close Window">closing the window</a>,
 <a rel="Set Window Size">resizing</a>,
 <a rel="Maximize Window">maximizing</a>,
 and <a rel="Fullscreen Window">fullscreening</a> a window.

 <section>
   <h3>Get Window Handle</h3>

   <table class="simple jsoncommand">
     <tr>
       <th>HTTP Method</th>
       <th>Path Template</th>
       <th>Notes</th>
     </tr>
     <tr>
       <td>GET</td>
       <td>/session/{sessionId}/window_handle</td>
       <td></td>
     </tr>
   </table>

   <p>The <a>Get Window Handle</a> command returns the <a>window
     handle</a> for the <a>current top-level browsing context</a>. It
     can be used as an argument to <a>Switch to Window</a>.

   <p>The <a>remote end steps</a> for the <dfn>Get Window Handle</dfn> command are:

     <ol>
       <li><p>If the <a>current top-level browsing context</a>
           is <a>no longer open</a>, return an error with code <a>no
           such window</a>.</li>

       <li><p>Let <var>data</var> be a new JSON Object.</li>

       <li><p>Set the property "<code>value</code>" on <var>data</var>
           to the value of the <a>window handle</a> associated with
           the <a>current top-level browsing context</a>.

           <li>Return <a>success</a> with data <var>data</var>.
     </ol>
   </section>

   <section>
     <h3>Get Window Handles</h3>

     <p>
       <table class="simple jsoncommand">
         <tr>
           <th>HTTP Method</th>
           <th>Path Template</th>
           <th>Notes</th>
         </tr>
         <tr>
           <td>GET</td>
           <td id='get-window_handles'>/session/{sessionId}/window_handles</td>
           <td></td>
         </tr>
       </table>

     <p>The <a>Get Window Handle</a> command returns a list
         of <a>window handle</a>s for every open <a>top-level browsing
         context</a>. The order in which the window handles are
         returned is arbitary.

     <p>The <a>remote end steps</a> for the <dfn>Get Window
     Handles</dfn> command are:</p>

     <ol>
       <li><p>Let <var>data</var> be a new JSON Object.</li>

       <li><p>Let <var>value</var> be a JSON list object</p></li>

       <li><p>For each <a>top-level browsing context</a> in the
           remote end, push the associated <a>window handle</a>
           to <var>value</var>.</li>

       <li><p>Set the property "<code>value</code>" on <var>data</var>
           to <var>value</var>.</li>

       <li>Return <a>success</a> with data <var>data</var>.
     </ol>

     <p class="note">In order to determine whether or not a particular interaction with the browser opens a new window one can obtain the set of <a href='#window-handle'>window handle</a> before the interaction is performed and compare it with the set after the action is performed.</p>
   </section>

   <section>
     <h3>Switch to Window</h3>
        <p>
          <table class="simple jsoncommand">
            <tr>
              <th>HTTP Method</th>
              <th>Path Template</th>
              <th>Notes</th>
            </tr>
            <tr>
              <td>POST</td>
              <td id='post-window'>/session/{sessionId}/window</td>
              <td></td>
            </tr>
          </table>
        <p>The Switch to Window command is used to select
          the <a>active top level browsing context</a> for the current
          session; i.e. the one that will be used for processing
          commands.

        <p>The <a>remote end steps</a> for the <dfn>Switch to
        Window</dfn> command are:</p>

        <ol>
          <li><p>Let <var>handle</var> be the result of <a>getting a
          property</a> named "handle" from the <var>parameters</var>
          argument.</li>

          <li><p>If <var>handle</var> is equal to the
          associated <a>window handle</a> for some <a>top-level
          browsing context</a> in the current session, set the
          session's <a>current top-level browsing context</a> to that
          browsing context and return <a>success</a> with data
          null.</li>

          <li><p>Otherwise, return <a>error</a> with code <a>no such
          window</a>.</p></li>
        </ol>
    </section>

   <section>
     <h3>Close Window</h3>
     <p>
       <table class="simple jsoncommand">
         <tr>
           <th>HTTP Method</th>
           <th>Path Template</th>
           <th>Notes</th>
         </tr>
         <tr>
           <td>DELETE</td>
           <td id='delete-window_handle'>/session/{sessionId}/window_handle</td>
           <td></td>
         </tr>
       </table>

     <p>The <a>remote end steps</a> for the <dfn>Close Window</dfn> command are:</p>
     <ol>
       <li><p>If the <a>current top-level browsing context</a> is <a>no longer open</a>,
           return an error with code <a>no such window</a>.</li>

       <!-- this can prompt to unload, in which case the operation really failed -->
       <li><p><a href="https://html.spec.whatwg.org/#closing-browsing-contexts">Close</a> the <a>current top-level browsing context</a></p></li>

       <li><p>If there are no more open <a>top-level browsing contexts</a>, then <a>close the session</a>.</p>

       <li>Return the result of running the <a>remote end steps</a> for the <a>Get Window Handles</a> command.
     </ol>
   </section>
  </section>

  <section>
    <h2>Resizing and Positioning Windows</h2>
    <p>All commands MUST be handled by the OS window that ultimately owns the current context.</p>
    <dl class='idl' title='dictionary WindowSize'>
      <dt>double height</dt>
      <dd>The height of the <a href='http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context'>top level browsing context</a> in <a href='http://www.w3.org/TR/css3-values/#absolute-lengths'>CSS reference pixels</a></dd>.
      <dt>double width</dt>
      <dd>The width of the <a href='http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context'>top level browsing context</a> in <a href='http://www.w3.org/TR/css3-values/#absolute-lengths'>CSS reference pixels</a></dd>.
    </dl>
    <section>
      <!-- setWindowSize() -->
      <h3>setWindowSize()</h3>
        <p>
          <table class="simple jsoncommand">
            <tr>
              <th>HTTP Method</th>
              <th>Path Template</th>
              <th>Notes</th>
            </tr>
            <tr>
              <td>POST</td>
              <td id='post-window_handle-size'>/session/{sessionId}/window/size</td>
              <td></td>
            </tr>
          </table>
        <p>
        Resizes the OS window currently receiving commands to have the <code>height</code> and <code>width</code> passed in as parameters.
        <p>If a request is made to resize a OS window to a size which cannot be performed (e.g. the browser has a minimum, or fixed OS window size, or the operating system does not support resizing windows at all as is the case in many phone OSs), an <code><a href="#status-unsupported-operation">unsupported operation</a></code> status code MUST be returned.</p>
        <p>After <code>setWindowSize</code>, the browser window MUST NOT be in the maximised state.</p>
        <dl class='parameters'>
          <dt>unsigned double width</dt>
          <dd>The "width" value refer to the javascript <code>window.outerwidth</code> property. If the User Agent does not support this property, it represents the width of the whole OS window including window chrome and window resizing borders/handles.</li></dd>
          <dt>unsigned double height</dt>
          <dd>The "height" value refer to the javascript <code>window.outerheight</code> property. If the User Agent does not support this property, it represents the width of the whole OS window including window chrome and window resizing borders/handles.</li></dd>

      </section>
      <section>
      <!-- getWindowSize() -->
      <h3>getWindowSize()</h3>
        <p>
          <table class="simple jsoncommand">
            <tr>
              <th>HTTP Method</th>
              <th>Path Template</th>
              <th>Notes</th>
            </tr>
            <tr>
              <td>GET</td>
              <td id='get-window_handle-size'>/session/{sessionId}/window/size</td>
              <td></td>
            </tr>
          </table>
        <p>
          A command named "getWindowSize()":
        <ol>
          <li>Create a <a>WindowSize</a> dictionary containing the <code><a href='#widl-WindowSize-height'>height</a></code> and <code><a href='#widl-WindowSize-width'>width</a></code> keys.
          <li>Populate <code><a href='#widl-WindowSize-width'>width</a></code> with the value of <code>window.outerwidth</code> property of the <a href='http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context'>top level browsing context</a> currently receiving commands in <a href='http://www.w3.org/TR/css3-values/#absolute-lengths'>CSS reference pixels</a>. If the User Agent does not support this property, it represents the width of the whole OS window including window chrome and window resizing borders/handles.</li>
          <li>Populate <code><a href='#widl-WindowSize-height'>height</a></code> with the value of <code>window.outerheight</code> property of the <a href='http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context'>top level browsing context</a> currently receiving commands in <a href='http://www.w3.org/TR/css3-values/#absolute-lengths'>CSS reference pixels</a>. If the User Agent does not support this property, it represents the width of the whole OS window including window chrome and window resizing borders/handles.</li>
          <li>Return <a>WindowSize</a></li>
        </ol>
      </section>

      <section>
      <!-- maximizeWindow() -->
      <h3>maximizeWindow()</h3>
        <p>
          <table class="simple jsoncommand">
            <tr>
              <th>HTTP Method</th>
              <th>Path Template</th>
              <th>Notes</th>
            </tr>
            <tr>
              <td>POST</td>
              <td id='get-window_handle-maximize'>/session/{sessionId}/window/maximize</td>
              <td></td>
            </tr>
          </table>
        <p>After  <code>maximizeWindow</code>, the OS window currently receving commands MUST be left as if the maximise button had been pressed if, and only if, the window manager of the OS supports this concept; it is not sufficient to leave the window "restored", but with the full screen dimensions.</p>
        <p>If a request is made to resize a window to a size which cannot be performed (e.g. the browser has a minimum, or fixed window size, or the operating system does not support resizing windows at all as is the case in many phone OSs), an <code><a href="#status-unsupported-operation">unsupported operation</a></code> status code MUST be returned.</p>
      </section>
      <section>
      <!-- fullscreenWindow -->
      <h3>fullscreenWindow()</h3>
        <p>After <code>fullscreenWindow</code>, the OS window currently receiving commands MUST be in full-screen mode. For those operating systems that support the concept, this MUST be equivalent to if the user requested the OS window be full screen.</p>

        <p>If the User Agent or OS does not support switching to full-screen mode, an <code><a href="#status-unsupported-operation">unsupported operation</a></code> status code MUST be returned.</p>
    </section>
  </section>
</section>
